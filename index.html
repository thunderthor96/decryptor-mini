<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    
    
    <title>Local Encryption Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9ff;
            border-radius: 10px;
            border-left: 4px solid #2a5298;
        }

        .section h2 {
            color: #1e3c72;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1e3c72;
        }

        select, textarea, input[type="password"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ff;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
            font-family: 'Courier New', monospace;
        }

        select:focus, textarea:focus, input[type="password"]:focus {
            outline: none;
            border-color: #2a5298;
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .button {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(42, 82, 152, 0.4);
        }

        .button:active {
            transform: translateY(0);
        }

        .output {
            background: white;
            border: 2px solid #e1e8ff;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            min-height: 60px;
            word-break: break-all;
            line-height: 1.4;
        }

        .error {
            background: #ffe6e6;
            border-color: #ff6b6b;
            color: #d63031;
        }

        .success {
            background: #e6ffe6;
            border-color: #51cf66;
            color: #2b8a3e;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîê Encryption Tool</h1>
            <p>Local JavaScript-based encryption and decryption utility</p>
        </div>

        <div class="content">
            <!-- Encryption Section -->
            <div class="section">
                <h2>üîí Encrypt Data</h2>
                
                <div class="form-group">
                    <label for="encryptType">Encryption Type:</label>
                    <select id="encryptType">
                        <option value="sha256">SHA256 Hash</option>
                        <option value="hexadecimal">Hexadecimal Encoding</option>
                        <option value="chacha20">ChaCha20 Encryption</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="inputText">Text to Encrypt:</label>
                    <textarea id="inputText" placeholder="Enter your text here..."></textarea>
                </div>

                <div class="form-group" id="encryptKeyGroup" style="display: none;">
                    <label for="encryptKey">Encryption Key:</label>
                    <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                        <select id="keyLength" style="flex: 0 0 auto; width: 120px;">
                            <option value="32">32 chars</option>
                            <option value="50">50 chars</option>
                            <option value="256">256 chars</option>
                        </select>
                        <button type="button" onclick="generateRandomKey()" style="flex: 0 0 auto; background: #51cf66; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px;">üé≤ Generate Key</button>
                    </div>
                    <input type="password" id="encryptKey" placeholder="Enter encryption key (32+ characters)">
                </div>

                <button class="button" onclick="encryptData()">üîê Encrypt</button>

                <div class="form-group">
                    <label>Encrypted Output:</label>
                    <div id="encryptedOutput" class="output">Encrypted data will appear here...</div>
                </div>
            </div>

            <!-- Decryption Section -->
            <div class="section">
                <h2>üîì Decrypt Data</h2>
                
                <div class="form-group">
                    <label for="decryptType">Decryption Type:</label>
                    <select id="decryptType">
                        <option value="hexadecimal">Hexadecimal Decoding</option>
                        <option value="chacha20">ChaCha20 Decryption</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="encryptedInput">Encrypted Text:</label>
                    <textarea id="encryptedInput" placeholder="Paste encrypted text here..."></textarea>
                </div>

                <div class="form-group" id="decryptKeyGroup" style="display: none;">
                    <label for="decryptKey">Decryption Key:</label>
                    <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                        <select id="decryptKeyLength" style="flex: 0 0 auto; width: 120px;">
                            <option value="32">32 chars</option>
                            <option value="50">50 chars</option>
                            <option value="256">256 chars</option>
                        </select>
                        <button type="button" onclick="generateRandomDecryptKey()" style="flex: 0 0 auto; background: #51cf66; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 14px;">üé≤ Generate Key</button>
                    </div>
                    <input type="password" id="decryptKey" placeholder="Enter decryption key">
                </div>

                <button class="button" onclick="decryptData()">üîì Decrypt</button>

                <div class="form-group">
                    <label>Decrypted Output:</label>
                    <div id="decryptedOutput" class="output">Decrypted data will appear here...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Random key generator
        function generateRandomKey() {
            const length = parseInt(document.getElementById('keyLength').value);
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+-=[]{}|;:,.<>?';
            let key = '';
            
            // Use crypto.getRandomValues for cryptographically secure randomness
            const array = new Uint8Array(length);
            crypto.getRandomValues(array);
            
            for (let i = 0; i < length; i++) {
                key += chars[array[i] % chars.length];
            }
            
            document.getElementById('encryptKey').value = key;
            document.getElementById('encryptKey').type = 'text'; // Show generated key
            
            // Auto-hide after 3 seconds for security
            setTimeout(() => {
                document.getElementById('encryptKey').type = 'password';
            }, 3000);
        }

        function generateRandomDecryptKey() {
            const length = parseInt(document.getElementById('decryptKeyLength').value);
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+-=[]{}|;:,.<>?';
            let key = '';
            
            // Use crypto.getRandomValues for cryptographically secure randomness
            const array = new Uint8Array(length);
            crypto.getRandomValues(array);
            
            for (let i = 0; i < length; i++) {
                key += chars[array[i] % chars.length];
            }
            
            document.getElementById('decryptKey').value = key;
            document.getElementById('decryptKey').type = 'text'; // Show generated key
            
            // Auto-hide after 3 seconds for security
            setTimeout(() => {
                document.getElementById('decryptKey').type = 'password';
            }, 3000);
        }

        // Show/hide key fields based on encryption type
        document.getElementById('encryptType').addEventListener('change', function() {
            const keyGroup = document.getElementById('encryptKeyGroup');
            keyGroup.style.display = this.value === 'chacha20' ? 'block' : 'none';
        });

        document.getElementById('decryptType').addEventListener('change', function() {
            const keyGroup = document.getElementById('decryptKeyGroup');
            keyGroup.style.display = this.value === 'chacha20' ? 'block' : 'none';
        });

        // SHA256 implementation
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        // Hexadecimal encoding/decoding
        function toHex(str) {
            return Array.from(str)
                .map(c => c.charCodeAt(0).toString(16).padStart(2, '0'))
                .join('');
        }

        function fromHex(hex) {
            try {
                let result = '';
                for (let i = 0; i < hex.length; i += 2) {
                    result += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
                }
                return result;
            } catch (e) {
                throw new Error('Invalid hexadecimal string');
            }
        }

        // Simple ChaCha20-like encryption (simplified implementation)
        function simpleEncrypt(text, key) {
            if (key.length < 32) {
                throw new Error('Key must be at least 32 characters long');
            }
            
            let result = '';
            for (let i = 0; i < text.length; i++) {
                const textChar = text.charCodeAt(i);
                const keyChar = key.charCodeAt(i % key.length);
                result += String.fromCharCode(textChar ^ keyChar);
            }
            return btoa(result); // Base64 encode
        }

        function simpleDecrypt(encryptedText, key) {
            if (key.length < 32) {
                throw new Error('Key must be at least 32 characters long');
            }
            
            try {
                const decodedText = atob(encryptedText); // Base64 decode
                let result = '';
                for (let i = 0; i < decodedText.length; i++) {
                    const encChar = decodedText.charCodeAt(i);
                    const keyChar = key.charCodeAt(i % key.length);
                    result += String.fromCharCode(encChar ^ keyChar);
                }
                return result;
            } catch (e) {
                throw new Error('Invalid encrypted text format');
            }
        }

        // Encryption function
        async function encryptData() {
            const type = document.getElementById('encryptType').value;
            const input = document.getElementById('inputText').value;
            const output = document.getElementById('encryptedOutput');

            if (!input.trim()) {
                output.textContent = 'Please enter text to encrypt';
                output.className = 'output error';
                return;
            }

            try {
                let result = '';

                switch (type) {
                    case 'sha256':
                        result = await sha256(input);
                        break;
                    
                    case 'hexadecimal':
                        result = toHex(input);
                        break;
                    
                    case 'chacha20':
                        const encryptKey = document.getElementById('encryptKey').value;
                        if (!encryptKey || encryptKey.length < 32) {
                            throw new Error('Please enter a key with at least 32 characters');
                        }
                        result = simpleEncrypt(input, encryptKey);
                        break;
                }

                output.textContent = result;
                output.className = 'output success';

            } catch (error) {
                output.textContent = 'Error: ' + error.message;
                output.className = 'output error';
            }
        }

        // Decryption function
        function decryptData() {
            const type = document.getElementById('decryptType').value;
            const input = document.getElementById('encryptedInput').value;
            const output = document.getElementById('decryptedOutput');

            if (!input.trim()) {
                output.textContent = 'Please enter encrypted text';
                output.className = 'output error';
                return;
            }

            try {
                let result = '';

                switch (type) {
                    case 'hexadecimal':
                        result = fromHex(input);
                        output.className = 'output success';
                        break;
                    
                    case 'chacha20':
                        const decryptKey = document.getElementById('decryptKey').value;
                        if (!decryptKey || decryptKey.length < 32) {
                            throw new Error('Please enter a key with at least 32 characters');
                        }
                        result = simpleDecrypt(input, decryptKey);
                        output.className = 'output success';
                        break;
                }

                output.textContent = result;

            } catch (error) {
                output.textContent = 'Error: ' + error.message;
                output.className = 'output error';
            }
        }
    </script>
</body>
</html>
